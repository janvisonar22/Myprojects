<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
	<t t-name="project_custom_dashboard.ProjectDashboard">

		<div class="o_project_dashboard p-4">

			<!-- Header -->
			<div class="d-flex justify-content-between align-items-center mb-4">
				<h2>ðŸ“Š Project KPI Dashboard</h2>
				<button type="button" class="btn btn-outline-primary" t-on-click="refreshData">
					ðŸ”„ Refresh
				</button>
			</div>

			<!-- KPI Tiles -->
			<div class="d-flex flex-wrap gap-3 mb-5 justify-content-around">

				<!-- Total Invoiced -->
				<div class="card text-white shadow-sm p-3 flex-fill"
					 style="background: linear-gradient(135deg, #4e73df, #1cc88a); min-width: 200px; transition: transform 0.3s, box-shadow 0.3s;"
					 t-on-click="() => this.openAction('invoiced')"
					 onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 12px 25px rgba(0,0,0,0.2)';"
					 onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h6>Total Invoiced</h6>
							<h3><t t-esc="state.kpis.total_invoiced"/></h3>
						</div>
						<i class="fa fa-dollar-sign fa-2x" style="opacity:0.8;"></i>
					</div>
				</div>

				<!-- Total Committed -->
				<div class="card text-white shadow-sm p-3 flex-fill"
					 style="background: linear-gradient(135deg, #36b9cc, #f6c23e); min-width: 200px; transition: transform 0.3s, box-shadow 0.3s;"
					 t-on-click="() => this.openAction('committed')"
					 onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 12px 25px rgba(0,0,0,0.2)';"
					 onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h6>Total Committed</h6>
							<h3><t t-esc="state.kpis.total_committed"/></h3>
						</div>
						<i class="fa fa-hand-holding-usd fa-2x" style="opacity:0.8;"></i>
					</div>
				</div>

				<!-- Uninvoiced -->
				<div class="card text-white shadow-sm p-3 flex-fill"
					 style="background: linear-gradient(135deg, #e74a3b, #f8f9fc); color:#000; min-width: 200px; transition: transform 0.3s, box-shadow 0.3s;"
					 t-on-click="() => this.openAction('uninvoiced')"
					 onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 12px 25px rgba(0,0,0,0.2)';"
					 onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h6>Uninvoiced</h6>
							<h3><t t-esc="state.kpis.total_uninvoiced"/></h3>
						</div>
						<i class="fa fa-file-invoice fa-2x" style="opacity:0.8;"></i>
					</div>
				</div>

				<!-- Timesheet Hours -->
				<div class="card text-white shadow-sm p-3 flex-fill"
					 style="background: linear-gradient(135deg, #1cc88a, #36b9cc); min-width: 200px; transition: transform 0.3s, box-shadow 0.3s;"
					 t-on-click="() => this.openAction('hours')"
					 onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 12px 25px rgba(0,0,0,0.2)';"
					 onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h6>Timesheet Hours</h6>
							<h3><t t-esc="state.kpis.total_hours"/></h3>
						</div>
						<i class="fa fa-clock fa-2x" style="opacity:0.8;"></i>
					</div>
				</div>

				<!-- Total Margin -->
				<div class="card text-white shadow-sm p-3 flex-fill"
					 style="background: linear-gradient(135deg, #f6c23e, #4e73df); min-width: 200px; transition: transform 0.3s, box-shadow 0.3s;"
					 t-on-click="() => this.openAction('margin')"
					 onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 12px 25px rgba(0,0,0,0.2)';"
					 onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h6>Total Margin</h6>
							<h3><t t-esc="state.kpis.total_margin"/></h3>
						</div>
						<i class="fa fa-chart-line fa-2x" style="opacity:0.8;"></i>
					</div>
				</div>

			</div>

			<!-- Project Table -->
			<table class="table table-bordered table-hover shadow-sm">
				<thead class="table-dark">
					<tr>
						<th>Project Name</th>
						<th>Revenue Invoiced</th>
						<th>Revenue Committed</th>
						<th>Uninvoiced</th>
						<th>Timesheet Hours</th>
						<th>% Complete</th>
						<th>Margin</th>
					</tr>
				</thead>
				<tbody>
					<t t-foreach="state.projects" t-as="proj" t-key="proj.id">
						<tr>
							<td>
								<a href="#" t-on-click="() => this.openAction(false, proj.id)">
									<t t-esc="proj.name"/>
								</a>
							</td>
							<td><t t-esc="proj.revenue_invoiced"/></td>
							<td><t t-esc="proj.revenue_committed"/></td>
							<td><t t-esc="proj.uninvoiced_amount"/></td>
							<td><t t-esc="proj.timesheet_hours"/></td>
							<td><t t-esc="proj.percent_complete"/>%</td>
							<td><t t-esc="proj.margin_estimate"/></td>
						</tr>
					</t>
				</tbody>
			</table>

			<!-- Pagination Buttons -->
			<div class="d-flex justify-content-between mt-3">
				<button class="btn btn-secondary" t-on-click="prevPage">â¬… Previous</button>
				<span>Page <t t-esc="state.current_page"/> of <t t-esc="Math.ceil(state.total_count / state.page_size)"/></span>
				<button class="btn btn-secondary" t-on-click="nextPage">Next âž¡</button>
			</div>
		</div>
	</t>
</templates>
